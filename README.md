# Skip Lists, Navigable Small World, and HNSW

A repo for re-implementation of Skip Lists, Navigable Small World, and HNSW from scratch in order to better understand the algorithms and their applicability to the problem of approximate nearest neighbor search.

## Run locally

```bash
npm install
```

## Run tests

```bash
npm test
```

## Run benchmarks

```bash
npm run bench
```

# Skip Lists

## Usage

```ts
import { SkipList } from "similarity-search-data-structures/skip-list";

const list = new SkipList<number>();
list.insert(1);
list.insert(2);
list.insert(3);

console.log(list.contains(2)); // true
console.log(list.contains(4)); // false
console.log(list.size()); // 3
console.log([...list]); // [1, 2, 3]
```

## Performance vs Array

```bash
┌─────────┬─────────────────────────┬──────────┬────────────────────┬───────────┬─────────┐
│ (index) │        Task Name        │ ops/sec  │ Average Time (ns)  │  Margin   │ Samples │
├─────────┼─────────────────────────┼──────────┼────────────────────┼───────────┼─────────┤
│    0    │ 'Skip List insert 1000' │   '35'   │ 28181376.399099827 │ '±46.46%' │   10    │
│    1    │    'Array push 1000'    │ '45,125' │ 22160.633127889258 │ '±48.33%' │  4914   │
│    2    │   'Array insert 1000'   │  '629'   │ 1587821.7814024538 │ '±15.25%' │   64    │
└─────────┴─────────────────────────┴──────────┴────────────────────┴───────────┴─────────┘
Benchmarking insert on 5000...
┌─────────┬─────────────────────────┬─────────┬────────────────────┬───────────┬─────────┐
│ (index) │        Task Name        │ ops/sec │ Average Time (ns)  │  Margin   │ Samples │
├─────────┼─────────────────────────┼─────────┼────────────────────┼───────────┼─────────┤
│    0    │ 'Skip List insert 5000' │   '0'   │ 1117985946.0994601 │ '±50.97%' │   10    │
│    1    │    'Array push 5000'    │ '9,098' │ 109908.01749976128 │ '±33.98%' │   910   │
│    2    │   'Array insert 5000'   │  '128'  │ 7766033.229919581  │ '±35.79%' │   13    │
└─────────┴─────────────────────────┴─────────┴────────────────────┴───────────┴─────────┘
Benchmarking find on 1000...
┌─────────┬───────────────────────┬─────────┬───────────────────┬──────────┬─────────┐
│ (index) │       Task Name       │ ops/sec │ Average Time (ns) │  Margin  │ Samples │
├─────────┼───────────────────────┼─────────┼───────────────────┼──────────┼─────────┤
│    0    │ 'Skip List find 1000' │ '6,271' │ 159463.6481801036 │ '±0.78%' │   628   │
│    1    │   'Array find 1000'   │  '137'  │ 7283381.216228008 │ '±2.73%' │   14    │
└─────────┴───────────────────────┴─────────┴───────────────────┴──────────┴─────────┘
Benchmarking find on 5000...
┌─────────┬───────────────────────┬─────────┬────────────────────┬──────────┬─────────┐
│ (index) │       Task Name       │ ops/sec │ Average Time (ns)  │  Margin  │ Samples │
├─────────┼───────────────────────┼─────────┼────────────────────┼──────────┼─────────┤
│    0    │ 'Skip List find 5000' │  '860'  │ 1162275.0341207131 │ '±2.12%' │   87    │
│    1    │   'Array find 5000'   │   '5'   │ 181989907.40180016 │ '±1.60%' │   10    │
└─────────┴───────────────────────┴─────────┴────────────────────┴──────────┴─────────┘
Benchmarking find on 10000...
┌─────────┬────────────────────────┬─────────┬────────────────────┬──────────┬─────────┐
│ (index) │       Task Name        │ ops/sec │ Average Time (ns)  │  Margin  │ Samples │
├─────────┼────────────────────────┼─────────┼────────────────────┼──────────┼─────────┤
│    0    │ 'Skip List find 10000' │  '766'  │ 1304246.9872282695 │ '±1.97%' │   77    │
│    1    │   'Array find 10000'   │  '42'   │ 23426736.602187157 │ '±1.37%' │   10    │
└─────────┴────────────────────────┴─────────┴────────────────────┴──────────┴─────────┘
Benchmarking delete on 5000...
┌─────────┬─────────────────────────┬─────────┬───────────────────┬──────────┬─────────┐
│ (index) │        Task Name        │ ops/sec │ Average Time (ns) │  Margin  │ Samples │
├─────────┼─────────────────────────┼─────────┼───────────────────┼──────────┼─────────┤
│    0    │ 'Skip List delete 5000' │ '1,726' │ 579043.8268742808 │ '±2.42%' │   173   │
│    1    │   'Array delete 5000'   │ '3,536' │ 282799.5479275278 │ '±1.84%' │   354   │
└─────────┴─────────────────────────┴─────────┴───────────────────┴──────────┴─────────┘
Benchmarking delete on 10000...
┌─────────┬──────────────────────────┬─────────┬────────────────────┬──────────┬─────────┐
│ (index) │        Task Name         │ ops/sec │ Average Time (ns)  │  Margin  │ Samples │
├─────────┼──────────────────────────┼─────────┼────────────────────┼──────────┼─────────┤
│    0    │ 'Skip List delete 10000' │  '871'  │ 1146889.9881636554 │ '±1.39%' │   88    │
│    1    │   'Array delete 10000'   │  '626'  │ 1596700.7973231375 │ '±2.83%' │   64    │
└─────────┴──────────────────────────┴─────────┴────────────────────┴──────────┴─────────┘
```

### Comparison with optimized Skip List implementation

```bash
┌─────────┬───────────────────────────────────┬─────────┬────────────────────┬───────────┬─────────┐
│ (index) │             Task Name             │ ops/sec │ Average Time (ns)  │  Margin   │ Samples │
├─────────┼───────────────────────────────────┼─────────┼────────────────────┼───────────┼─────────┤
│    0    │      'Skip List insert 1000'      │  '35'   │ 28342918.203771114 │ '±46.92%' │   10    │
│    1    │ 'Optimized Skip List insert 1000' │  '104'  │ 9582289.817658337  │ '±40.46%' │   11    │
└─────────┴───────────────────────────────────┴─────────┴────────────────────┴───────────┴─────────┘
Benchmarking insert on 5000...
┌─────────┬───────────────────────────────────┬─────────┬───────────────────┬───────────┬─────────┐
│ (index) │             Task Name             │ ops/sec │ Average Time (ns) │  Margin   │ Samples │
├─────────┼───────────────────────────────────┼─────────┼───────────────────┼───────────┼─────────┤
│    0    │      'Skip List insert 5000'      │   '0'   │ 1284684224.395454 │ '±61.10%' │   10    │
│    1    │ 'Optimized Skip List insert 5000' │   '2'   │ 348372035.2977514 │ '±57.61%' │   10    │
└─────────┴───────────────────────────────────┴─────────┴───────────────────┴───────────┴─────────┘
Benchmarking find on 1000...
┌─────────┬─────────────────────────────────┬─────────┬────────────────────┬──────────┬─────────┐
│ (index) │            Task Name            │ ops/sec │ Average Time (ns)  │  Margin  │ Samples │
├─────────┼─────────────────────────────────┼─────────┼────────────────────┼──────────┼─────────┤
│    0    │      'Skip List find 1000'      │ '6,259' │ 159766.46973397405 │ '±1.44%' │   626   │
│    1    │ 'Optimized Skip List find 1000' │ '5,727' │ 174602.9264015677  │ '±2.16%' │   573   │
└─────────┴─────────────────────────────────┴─────────┴────────────────────┴──────────┴─────────┘
Benchmarking find on 5000...
┌─────────┬─────────────────────────────────┬─────────┬────────────────────┬──────────┬─────────┐
│ (index) │            Task Name            │ ops/sec │ Average Time (ns)  │  Margin  │ Samples │
├─────────┼─────────────────────────────────┼─────────┼────────────────────┼──────────┼─────────┤
│    0    │      'Skip List find 5000'      │  '805'  │ 1241422.6051833893 │ '±1.41%' │   81    │
│    1    │ 'Optimized Skip List find 5000' │  '879'  │ 1136474.7616039081 │ '±1.07%' │   88    │
└─────────┴─────────────────────────────────┴─────────┴────────────────────┴──────────┴─────────┘
Benchmarking find on 10000...
┌─────────┬──────────────────────────────────┬─────────┬────────────────────┬──────────┬─────────┐
│ (index) │            Task Name             │ ops/sec │ Average Time (ns)  │  Margin  │ Samples │
├─────────┼──────────────────────────────────┼─────────┼────────────────────┼──────────┼─────────┤
│    0    │      'Skip List find 10000'      │  '760'  │ 1315021.260024665  │ '±2.20%' │   77    │
│    1    │ 'Optimized Skip List find 10000' │  '664'  │ 1504726.0431656197 │ '±1.68%' │   67    │
└─────────┴──────────────────────────────────┴─────────┴────────────────────┴──────────┴─────────┘
Benchmarking delete on 5000...
┌─────────┬───────────────────────────────────┬─────────┬───────────────────┬──────────┬─────────┐
│ (index) │             Task Name             │ ops/sec │ Average Time (ns) │  Margin  │ Samples │
├─────────┼───────────────────────────────────┼─────────┼───────────────────┼──────────┼─────────┤
│    0    │      'Skip List delete 5000'      │ '1,618' │ 617953.9391104087 │ '±2.85%' │   162   │
│    1    │ 'Optimized Skip List delete 5000' │ '1,485' │ 673307.4965292976 │ '±2.17%' │   149   │
└─────────┴───────────────────────────────────┴─────────┴───────────────────┴──────────┴─────────┘
Benchmarking delete on 10000...
┌─────────┬────────────────────────────────────┬─────────┬────────────────────┬──────────┬─────────┐
│ (index) │             Task Name              │ ops/sec │ Average Time (ns)  │  Margin  │ Samples │
├─────────┼────────────────────────────────────┼─────────┼────────────────────┼──────────┼─────────┤
│    0    │      'Skip List delete 10000'      │  '891'  │ 1121963.7892312473 │ '±1.73%' │   90    │
│    1    │ 'Optimized Skip List delete 10000' │  '634'  │ 1576983.8427659124 │ '±7.23%' │   64    │
└─────────┴────────────────────────────────────┴─────────┴────────────────────┴──────────┴─────────┘
```
